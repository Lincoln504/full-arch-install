# Sway Configuration File (EDITED VERSION - remove bindgesture block and power_handler exec)

# Variables
set $mod Mod4
set $term alacritty
set $menu wofi --show drun
# $scripts_dir variable is not used if power_handler is removed, but keep if other scripts use it
# set $scripts_dir $HOME/.config/sway/scripts

# Font
font pango:Fira Code 8.8

# Appearance
gaps inner 5
default_border pixel 2

# Colors
client.focused          #a1a1a1 #a1a1a1    #FFFFFF #a1a1a1  #a1a1a1
client.focused_inactive #373737 #373737    #FFFFFF #373737  #373737
client.unfocused        #373737 #373737    #888888 #373737  #373737
client.urgent           #EC69A0 #DB3279    #FFFFFF #DB3279  #DB3279
client.placeholder      #000000 #0C0C0C    #FFFFFF #000000  #0C0C0C
client.background       #FFFFFF

# Input Devices
input "type:keyboard" {
    xkb_layout us
    repeat_delay 250
    repeat_rate 45
}

input "type:touchpad" {
    tap enabled
    natural_scroll enabled
    dwt enabled
    middle_emulation enabled
    accel_profile "flat"
}

# Tablet Configuration
input "1386:5091:Wacom_HID_5091_Pen" {
    map_to_output "*"
}

input "1386:5091:Wacom_HID_5091_Finger" {
    map_to_output "*"
}

# Key Bindings
bindsym {
    $mod+Return exec $term
    $mod+Shift+q kill
    $mod+d exec $menu
    $mod+Left focus left
    $mod+Right focus right
    $mod+Up focus up
    $mod+Down focus down
    $mod+Shift+Left move left
    $mod+Shift+Right move right
    $mod+Shift+Up move up
    $mod+Shift+Down move down
}

# Workspaces
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

# Layout Management
bindsym $mod+h split h
bindsym $mod+v split v
bindsym $mod+f fullscreen toggle
bindsym $mod+Shift+space floating toggle

# Media Controls
bindsym XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle
bindsym XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -5%
bindsym XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +5%

# Screenshots
bindsym Print exec grim - | wl-copy
bindsym $mod+Print exec grim -g "$(slurp)" - | wl-copy

# Application Autostart
exec {
    nm-applet --indicator
    xdg-desktop-portal-wlr # Still potentially useful
    # REMOVED: $scripts_dir/power_handler.sh
    # Start wallpaper script (assuming it's copied to ~/.local/bin by ansible)
    ~/.local/bin/wallpaper.sh
}

# Window Rules
for_window [app_id="^calculator$"] floating enable, border pixel 2
for_window [class="Spotify"] floating enable
for_window [title="Library"] floating enable, resize set 800 600

# REMOVED bindgesture block - rely on libinput-gestures daemon

# Bar Configuration
bar {
    position top
    status_command waybar
    workspace_buttons yes
    strip_workspace_numbers yes

    colors {
        statusline #ffffff
        focused_workspace #4c7899 #285577 #ffffff
        active_workspace #333333 #222222 #ffffff
        inactive_workspace #333333 #222222 #888888
    }
}

# Reload Waybar
bindsym $mod+Shift+r exec pkill -SIGUSR2 waybar || waybar & # Try reload, else start

# Seat Configuration (Needed for seatd)
seat seat0 {
    # Add input devices here if auto-detection fails for specific devices
}
